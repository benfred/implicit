<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AlternatingLeastSquares &mdash; Implicit 0.6.0 documentation</title><link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="BayesianPersonalizedRanking" href="bpr.html" />
    <link rel="prev" title="CPU Models" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Implicit
          </a>
              <div class="version">
                0.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html"> Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial_lastfm.html"> Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html"> API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../recommender_base.html"> RecommenderBase</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html"> CPU Models</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#"> AlternatingLeastSquares</a></li>
<li class="toctree-l4"><a class="reference internal" href="bpr.html"> BayesianPersonalizedRanking</a></li>
<li class="toctree-l4"><a class="reference internal" href="lmf.html"> LogisticMatrixFactorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="knn.html"> Nearest Neighbours Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="matrix_factorization_base.html"> MatrixFactorizationBase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu/index.html"> GPU Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluation.html">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ann.html">Approximate Nearest Neighbours</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../resources.html"> Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Implicit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">API Reference</a> &raquo;</li>
          <li><a href="../index.html">Recommendation Models</a> &raquo;</li>
          <li><a href="index.html">CPU Models</a> &raquo;</li>
      <li>AlternatingLeastSquares</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/api/models/cpu/als.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="alternatingleastsquares">
<h1>AlternatingLeastSquares<a class="headerlink" href="#alternatingleastsquares" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt id="implicit.cpu.als.AlternatingLeastSquares">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">implicit.cpu.als.</span></code><code class="sig-name descname"><span class="pre">AlternatingLeastSquares</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">factors=100</span></em>, <em class="sig-param"><span class="pre">regularization=0.01</span></em>, <em class="sig-param"><span class="pre">alpha=1.0</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em>, <em class="sig-param"><span class="pre">use_native=True</span></em>, <em class="sig-param"><span class="pre">use_cg=True</span></em>, <em class="sig-param"><span class="pre">iterations=15</span></em>, <em class="sig-param"><span class="pre">calculate_training_loss=False</span></em>, <em class="sig-param"><span class="pre">num_threads=0</span></em>, <em class="sig-param"><span class="pre">random_state=None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="matrix_factorization_base.html#implicit.cpu.matrix_factorization_base.MatrixFactorizationBase" title="implicit.cpu.matrix_factorization_base.MatrixFactorizationBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">implicit.cpu.matrix_factorization_base.MatrixFactorizationBase</span></code></a></p>
<p>Alternating Least Squares</p>
<p>A Recommendation Model based off the algorithms described in the paper ‘Collaborative
Filtering for Implicit Feedback Datasets’ with performance optimizations described in
‘Applications of the Conjugate Gradient Method for Implicit Feedback Collaborative
Filtering.’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of latent factors to compute</p></li>
<li><p><strong>regularization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – The regularization factor to use</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – The weight to give to positive examples.</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em><em>, </em><em>optional</em>) – Specifies whether to generate 64 bit or 32 bit floating point factors</p></li>
<li><p><strong>use_native</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Use native extensions to speed up model fitting</p></li>
<li><p><strong>use_cg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Use a faster Conjugate Gradient solver to calculate factors</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of ALS iterations to use when fitting data</p></li>
<li><p><strong>calculate_training_loss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to log out the training loss at each iteration</p></li>
<li><p><strong>num_threads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of threads to use for fitting the model and batch recommend calls.
Specifying 0 means to default to the number of cores on the machine.</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v1.23)"><em>numpy.random.RandomState</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The random state for seeding the initial item and user factors.
Default is None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="implicit.cpu.als.AlternatingLeastSquares.item_factors">
<code class="sig-name descname"><span class="pre">item_factors</span></code><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.item_factors" title="Permalink to this definition"></a></dt>
<dd><p>Array of latent factors for each item in the training set</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="implicit.cpu.als.AlternatingLeastSquares.user_factors">
<code class="sig-name descname"><span class="pre">user_factors</span></code><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.user_factors" title="Permalink to this definition"></a></dt>
<dd><p>Array of latent factors for each user in the training set</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.fit">
<code class="sig-name descname"><span class="pre">fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.fit" title="Permalink to this definition"></a></dt>
<dd><p>Factorizes the user_items matrix.</p>
<p>After calling this method, the members ‘user_factors’ and ‘item_factors’ will be
initialized with a latent factor model of the input data.</p>
<p>The user_items matrix does double duty here. It defines which items are liked by which
users (P_ui in the original paper), as well as how much confidence we have that the user
liked the item (C_ui).</p>
<p>The negative items are implicitly defined: This code assumes that positive items in the
user_items matrix means that the user liked the item. The negatives are left unset in this
sparse matrix: the library will assume that means Piu = 0 and Ciu = 1 for all these items.
Negative items can also be passed with a higher confidence value by passing a negative
value, indicating that the user disliked the item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_items</strong> (<em>csr_matrix</em>) – Matrix of confidences for the liked items. This matrix should be a csr_matrix where
the rows of the matrix are the users, the columns are the items liked that user,
and the value is the confidence that the user liked the item.</p></li>
<li><p><strong>show_progress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to show a progress bar during fitting</p></li>
<li><p><strong>fit_callback</strong> (<em>Callable</em><em>, </em><em>optional</em>) – Callable function on each epoch with such arguments as epoch, elapsed time and progress</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.recalculate_user">
<code class="sig-name descname"><span class="pre">recalculate_user</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.recalculate_user" title="Permalink to this definition"></a></dt>
<dd><p>Recalculates factors for a batch of users</p>
<p>This method recalculates factors for a batch of users and returns
the factors without storing on the object. For updating the model
using ‘partial_fit_users’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userid</strong> (<em>Union</em><em>[</em><em>array_like</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – The userid or array of userids to recalculate</p></li>
<li><p><strong>user_items</strong> (<em>csr_matrix</em>) – Sparse matrix of (users, items) that contain the users that liked
each item.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.recalculate_item">
<code class="sig-name descname"><span class="pre">recalculate_item</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itemid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_users</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.recalculate_item" title="Permalink to this definition"></a></dt>
<dd><p>Recalculates factors for a batch of items</p>
<p>This recalculates factors for a batch of items, returns the newly
calculated values without storing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>itemid</strong> (<em>Union</em><em>[</em><em>array_like</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – The itemid or array of itemids to recalculate</p></li>
<li><p><strong>item_users</strong> (<em>csr_matrix</em>) – Sparse matrix of (items, users) that contain the users that liked
each item</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.partial_fit_users">
<code class="sig-name descname"><span class="pre">partial_fit_users</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.partial_fit_users" title="Permalink to this definition"></a></dt>
<dd><p>Incrementally updates user factors</p>
<p>This method updates factors for users specified by userids, given a
sparse matrix of items that they have interacted with before. This
allows you to retrain only parts of the model with new data, and
avoid a full retraining when new users appear - or the liked
items for an existing user change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userids</strong> (<em>array_like</em>) – An array of userids to calculate new factors for</p></li>
<li><p><strong>user_items</strong> (<em>csr_matrix</em>) – Sparse matrix containing the liked items for each user. Each row in this
matrix corresponds to a row in userids.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.partial_fit_items">
<code class="sig-name descname"><span class="pre">partial_fit_items</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itemids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_users</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.partial_fit_items" title="Permalink to this definition"></a></dt>
<dd><p>Incrementally updates item factors</p>
<p>This method updates factors for items specified by itemids, given a
sparse matrix of users that have interacted with them. This
allows you to retrain only parts of the model with new data, and
avoid a full retraining when new users appear - or the liked
users for an existing item change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>itemids</strong> (<em>array_like</em>) – An array of itemids to calculate new factors for</p></li>
<li><p><strong>item_users</strong> (<em>csr_matrix</em>) – Sparse matrix containing the liked users for each item in itemids</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.explain">
<code class="sig-name descname"><span class="pre">explain</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itemid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.explain" title="Permalink to this definition"></a></dt>
<dd><p>Provides explanations for why the item is liked by the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The userid to explain recommendations for</p></li>
<li><p><strong>user_items</strong> (<em>csr_matrix</em>) – Sparse matrix containing the liked items for the user</p></li>
<li><p><strong>itemid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The itemid to explain recommendations for</p></li>
<li><p><strong>user_weights</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Precomputed Cholesky decomposition of the weighted user liked items.
Useful for speeding up repeated calls to this function, this value
is returned</p></li>
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of liked items to show the contribution for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>total_score</strong> (<em>float</em>) – The total predicted score for this user/item pair</p></li>
<li><p><strong>top_contributions</strong> (<em>list</em>) – A list of the top N (itemid, score) contributions for this user/item pair</p></li>
<li><p><strong>user_weights</strong> (<em>ndarray</em>) – A factorized representation of the user. Passing this in to
future ‘explain’ calls will lead to noticeable speedups</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.to_gpu">
<code class="sig-name descname"><span class="pre">to_gpu</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.to_gpu" title="Permalink to this definition"></a></dt>
<dd><p>Converts this model to an equivalent version running on the gpu</p>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.save">
<code class="sig-name descname"><span class="pre">save</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileobj_or_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.save" title="Permalink to this definition"></a></dt>
<dd><p>Saves the model to a file, using the numpy <cite>.npz</cite> format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/io.html#io.IOBase" title="(in Python v3.10)"><em>io.IOBase</em></a>) – Either the filename or an open file-like object to save the model to</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#implicit.cpu.als.AlternatingLeastSquares.load" title="implicit.cpu.als.AlternatingLeastSquares.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.savez.html#numpy.savez" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.savez</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.load">
<em class="property"><span class="pre">classmethod</span> </em><code class="sig-name descname"><span class="pre">load</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileobj_or_path</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../recommender_base.html#implicit.recommender_base.RecommenderBase" title="implicit.recommender_base.RecommenderBase"><span class="pre">implicit.recommender_base.RecommenderBase</span></a><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.load" title="Permalink to this definition"></a></dt>
<dd><p>Loads the model from a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fileobj_or_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/io.html#io.IOBase" title="(in Python v3.10)"><em>io.IOBase</em></a>) – Either the filename or an open file-like object to load the model from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The model loaded up from disk</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../recommender_base.html#implicit.recommender_base.RecommenderBase" title="implicit.recommender_base.RecommenderBase">RecommenderBase</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#implicit.cpu.als.AlternatingLeastSquares.save" title="implicit.cpu.als.AlternatingLeastSquares.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.load</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.recommend">
<code class="sig-name descname"><span class="pre">recommend</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_already_liked_items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.recommend" title="Permalink to this definition"></a></dt>
<dd><p>Recommends items for users.</p>
<p>This method allows you to calculate the top N recommendations for a user or
batch of users. Passing an array of userids instead of a single userid will
tend to be more efficient, and allows multi-thread processing on the CPU.</p>
<p>This method has options for filtering out items from the results. You can both
filter out items that have already been liked by the user with the
filter_already_liked_items parameter, as well as pass in filter_items to filter
out other items for all users in the batch. By default all items in the training
dataset are scored, but by setting the ‘items’ parameter you can restrict down to
a subset.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the top recommendations for a single user</span>
<span class="n">ids</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">user_items</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># calculate the top recommendations for a batch of users</span>
<span class="n">userids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ids</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span><span class="n">userids</span><span class="p">,</span> <span class="n">user_items</span><span class="p">[</span><span class="n">userids</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userid</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>array_like</em><em>]</em>) – The userid or array of userids to calculate recommendations for</p></li>
<li><p><strong>user_items</strong> (<em>csr_matrix</em>) – A sparse matrix of shape (users, number_items). This lets us look
up the liked items and their weights for the user. This is used to filter out
items that have already been liked from the output, and to also potentially
recalculate the user representation. Each row in this sparse matrix corresponds
to a row in the userid parameter: that is the first row in this matrix contains
the liked items for the first user in the userid array.</p></li>
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of results to return</p></li>
<li><p><strong>filter_already_liked_items</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – When true, don’t return items present in the training set that were rated
by the specified user.</p></li>
<li><p><strong>filter_items</strong> (<em>array_like</em><em>, </em><em>optional</em>) – List of extra item ids to filter out from the output</p></li>
<li><p><strong>recalculate_user</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – When true, don’t rely on stored user embeddings and instead recalculate from the
passed in user_items. This option isn’t supported by all models.</p></li>
<li><p><strong>items</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Array of extra item ids. When set this will only rank the items in this array instead
of ranking every item the model was fit for. This parameter cannot be used with
filter_items</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (itemids, scores) arrays. When calculating for a single user these array will
be 1-dimensional with N items. When passed an array of userids, these will be
2-dimensional arrays with a row for each user.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.similar_items">
<code class="sig-name descname"><span class="pre">similar_items</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itemid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recalculate_item</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_users</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.similar_items" title="Permalink to this definition"></a></dt>
<dd><p>Calculates a list of similar items</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>itemid</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>array_like</em><em>]</em>) – The item id or an array of item ids to retrieve similar items for</p></li>
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of similar items to return</p></li>
<li><p><strong>recalculate_item</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – When true, don’t rely on stored item state and instead recalculate from the
passed in item_users</p></li>
<li><p><strong>item_users</strong> (<em>csr_matrix</em><em>, </em><em>optional</em>) – A sparse matrix of shape (itemid, number_users). This lets us look
up the users for each item. This is only needs to be set when setting
recalculate_item=True. This should have the same number of rows as
the itemid parameter, with the first row of the sparse matrix corresponding
to the first item in the itemid array.</p></li>
<li><p><strong>filter_items</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array of item ids to filter out from the results being returned</p></li>
<li><p><strong>items</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array of item ids to include in the output. If not set all items in the training
set will be included. Cannot be used with the filter_items options</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (itemids, scores) arrays</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="implicit.cpu.als.AlternatingLeastSquares.similar_users">
<code class="sig-name descname"><span class="pre">similar_users</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">userid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_users</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">users</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#implicit.cpu.als.AlternatingLeastSquares.similar_users" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the most similar users for a userid or array of userids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>userid</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>array_like</em><em>]</em>) – The userid or an array of userids to retrieve similar users for.</p></li>
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of similar users to return</p></li>
<li><p><strong>filter_users</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array of user ids to filter out from the results being returned</p></li>
<li><p><strong>users</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array of user ids to include in the output. If not set all users in the training
set will be included. Cannot be used with the filter_users options</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (userids, scores) arrays</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="CPU Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bpr.html" class="btn btn-neutral float-right" title="BayesianPersonalizedRanking" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2022, Ben Frederickson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>